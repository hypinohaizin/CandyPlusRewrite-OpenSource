package me.hypinohaizin.candyplusrewrite.module.exploit;

import me.hypinohaizin.candyplusrewrite.setting.Setting;
import me.hypinohaizin.candyplusrewrite.module.Module;
import me.hypinohaizin.candyplusrewrite.event.events.network.PacketEvent;
import net.minecraft.network.Packet;
import net.minecraft.network.play.client.*;

public class PacketCanceller extends Module {

    public Setting<Boolean> confirmTeleport;
    public Setting<Boolean> chatMessage;
    public Setting<Boolean> confirmTransaction;
    public Setting<Boolean> useEntity;
    public Setting<Boolean> keepAlive;
    public Setting<Boolean> player;
    public Setting<Boolean> vehicleMove;
    public Setting<Boolean> playerAbilities;
    public Setting<Boolean> playerDigging;
    public Setting<Boolean> entityAction;
    public Setting<Boolean> input;
    public Setting<Boolean> tryUseItemOnBlock;
    public Setting<Boolean> tryUseItem;

    public PacketCanceller() {
        super("PacketCanceller", Categories.EXPLOIT, false, false);

        confirmTeleport = register(new Setting<>("ConfirmTeleport", true));
        chatMessage = register(new Setting<>("ChatMessage", true));
        confirmTransaction = register(new Setting<>("ConfirmTransaction", true));
        useEntity = register(new Setting<>("UseEntity", true));
        keepAlive = register(new Setting<>("KeepAlive", true));
        player = register(new Setting<>("Player", true));
        vehicleMove = register(new Setting<>("VehicleMove", true));
        playerAbilities = register(new Setting<>("PlayerAbilities", true));
        playerDigging = register(new Setting<>("PlayerDigging", true));
        entityAction = register(new Setting<>("EntityAction", true));
        input = register(new Setting<>("Input", true));
        tryUseItemOnBlock = register(new Setting<>("TryUseItemOnBlock", true));
        tryUseItem = register(new Setting<>("TryUseItem", true));
    }

    @Override
    public void onPacketSend(PacketEvent.Send event) {
        Packet<?> packet = event.getPacket();
        if (packet instanceof CPacketConfirmTeleport && confirmTeleport.getValue())
            event.cancel();
        if (packet instanceof CPacketChatMessage && chatMessage.getValue())
            event.cancel();
        if (packet instanceof CPacketConfirmTransaction && confirmTransaction.getValue())
            event.cancel();
        if (packet instanceof CPacketUseEntity && useEntity.getValue())
            event.cancel();
        if (packet instanceof CPacketKeepAlive && keepAlive.getValue())
            event.cancel();
        if ((packet instanceof CPacketPlayer ||
                packet instanceof CPacketPlayer.Position ||
                packet instanceof CPacketPlayer.PositionRotation ||
                packet instanceof CPacketPlayer.Rotation) && player.getValue())
            event.cancel();
        if (packet instanceof CPacketVehicleMove && vehicleMove.getValue())
            event.cancel();
        if (packet instanceof CPacketPlayerAbilities && playerAbilities.getValue())
            event.cancel();
        if (packet instanceof CPacketPlayerDigging && playerDigging.getValue())
            event.cancel();
        if (packet instanceof CPacketEntityAction && entityAction.getValue())
            event.cancel();
        if (packet instanceof CPacketInput && input.getValue())
            event.cancel();
        if (packet instanceof CPacketPlayerTryUseItemOnBlock && tryUseItemOnBlock.getValue())
            event.cancel();
        if (packet instanceof CPacketPlayerTryUseItem && tryUseItem.getValue())
            event.cancel();
    }
}
